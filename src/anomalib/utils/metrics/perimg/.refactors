Refactors to make at the final PR of the feature branch.

